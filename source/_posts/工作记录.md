---
title: 工作记录
copyright: true
date: 2021-02-25 17:24:11
tags: 日常
---

## 1. 使用iframe的时候，自动改变iframe 的高度
场景： A页面使用iframe 把B页面嵌入进去。B页面有几个tab切换，所以需要随时的更新 iframe 的高度。
方案： 使用postMessage

A页面
```javascript
    window.addEventListener('message', (event) => {
      const { data, origin } = event
      console.log(data)
      if (!origin) return
      this.height = data.height
    }, false)
```

B 页面发送message, 在需要告知A页面中ifrme的高度的时候，就触发这个方法。实时更新iframe 的高度
```javascript
    let height = document.querySelector('.mall-wrapper').clientHeight
    window.parent.postMessage({ height }, targetOrigin)
```


## 2. 使用.bablerc 配置无效，但是在webpack.config.js的babel-loader里面配置有效
原因是因为使用的babel-loader 是 7版本以上， 配置文件要使用babel.config.js


## 3. 使用postcss 插件使css3 自动添加前缀
说明： `postcss` 是一个解析css的插件
      `postcss-preset-env中` 包含 `autoprefixer`

版本号: 
`postcss-loader 4.2.0`
`autoprefixer: 9.8.6`
版本号一定要符合，不然的话，会报错。

webpack配置：
```
{
        test: /\.css$/,
        use: ["style-loader", "css-loader",
        {
          loader: "postcss-loader",
          options: {
            postcssOptions: {
              plugins: {"autoprefixer": {overrideBrowserslist: ['last 2 version', '>0.5%', 'ios 9']} }
            }
          } 
        }
      ],
```
### 注意
postcss-loader 执行顺序必须保证在 css-loader 之前，建议还是放在 less或者 sass 等预处理器之后更好。即 loader 顺序：less-loader -> postcss-loader -> css-loader -> style-loader 或者 MiniCssExtractPlugin.loader，其实 postcss-loader 放在 less-loader 之前问题也不大，平时使用的 less 里面的语法基本不会和 autoprefixer 处理产生冲突的。
